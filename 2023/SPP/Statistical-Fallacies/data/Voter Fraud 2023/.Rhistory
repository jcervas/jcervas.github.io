ggplot(Conglomerate_Absentee, aes(y = Porp_Trump_Absentee, x = Porp_Trump_election_day, color = County))+
geom_point()+
geom_smooth(method = 'lm', formula = y ~ x)+
geom_point(aes(x = Porp_Trump_election_day, y = Porp_Trump_Absentee, color = County),
data = subset(Conglomerate_Absentee, Border == "Border"))+
geom_point(aes(x = Porp_Trump_election_day, y = Porp_Trump_Absentee), color = "yellow", shape = 1,
data = subset(Conglomerate_Absentee, Border == "Border"))+
theme_light()+
ggtitle("Absentee % Vs Trump Vote; Allegheny & Surrounding Counties, Pennsylvania")+
labs(y = "% Total Votes Mailed In",
x = "% Votes for Trump Out of Total",
subtitle = "By Precinct, 2020 Presidential Election",
caption = quote(NULL))+
scale_colour_manual(values=c("darkblue", "darkorange3" ,"coral","firebrick1","firebrick4"))
Conglomerate_Absentee_data <- Conglomerate_Absentee %>% # Combine Election results with census data
dplyr::mutate(County_CAP = toupper(County)) %>%
dplyr::left_join(dplyr::select(sf::st_drop_geometry(State_Precinct), c("VTDST20", "GEOID20", "CTYNAME")),
by = c("County_CAP" = "CTYNAME", "VTDST20")) %>%
dplyr::left_join(dplyr::select(BlockGroup_overlap_summarise, c("GEOID", census_block_variables)),
by = c("GEOID20" = "GEOID")) %>%
dplyr::distinct(GEOID20, .keep_all = TRUE)
Conglomerate_Absentee_Border <- Conglomerate_Absentee_data %>% # Subset border precincts
subset(Border == "Border") %>%
mutate(Border_lm = replace(Border, is.na(Border), "Interior"),
County_lm = replace(County, County != "Allegheny", "Exterior"))
plot_PA_Abs_EDV_UP <- ggplot(Conglomerate_Absentee_Border,
aes(y = Porp_Trump_Absentee, x = Porp_Trump_election_day, color = County_lm))+
geom_point()+
theme_light()+
ggtitle("Figure 1: Trump % Absentee Vs Election-Day Vote; Allegheny & Surrounding County Border Precincts")+
labs(
y = "% of Mail-In Votes for Trump out of Total Mail-In Ballots Cast",
x = "% of Election-Day Votes for Trump out of Total Election-Day Ballots Cast",
subtitle = "2020 Presidential Election",
caption = quote(NULL),
color = "Border Precincts")+
scale_colour_manual(values=c("darkblue", "firebrick1"))+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(labels = scales::percent)+
theme(legend.position='top')
plot_PA_Abs_EDV_UP
mach_O <- Conglomerate_Absentee_data %>% # Combine outer precincts with data
dplyr::select(c("GEOID20", Conglomerate_Absentee_variables, census_block_variables)) %>%
dplyr::right_join(dplyr::select(Adjacent_Border, GEOID_A), by = c("GEOID20" = "GEOID_A")) %>%
dplyr::select(!GEOID20)
mach_I <- Conglomerate_Absentee_data %>% # Combine inner precincts with data
dplyr::select(c("GEOID20", Conglomerate_Absentee_variables, census_block_variables)) %>%
dplyr::right_join(dplyr::select(Adjacent_Border, GEOID_B), by = c("GEOID20" = "GEOID_B")) %>%
dplyr::select(!GEOID20)
Precinct_match_data <- (mach_I - mach_O) %>% na.omit # Appears to be inner precincts minus outer precincts
ggplot()+
geom_point(aes(x = Porp_Trump, y = Porp_Absentee), data = Precinct_match_data)+
geom_smooth(aes(x = Porp_Trump, y = Porp_Absentee), data = Precinct_match_data,
method = 'lm', formula = y ~ x)+
theme_light()+
ggtitle("Absentee % Vs Trump Vote; Allegheny & Surrounding Counties, Pennsylvania")+
labs(y = "% Total Votes Mailed In",
x = "% Votes for Trump Out of Total",
subtitle = "By Precinct, 2020 Presidential Election",
caption = quote(NULL))
State_Precinct_County_Spatial <- State_Precinct_County %>% # Convert precincts to spatial format for matching
sf::as_Spatial()
Adjacent_Precinct_County_Wall <- spdep::poly2nb(sp::as.SpatialPolygons.PolygonsList(State_Precinct_County_Spatial@polygons),
snap = poly2nb_snap) # Initialize matching list
# precinct matching pairs
length_index <- sapply(Adjacent_Precinct_County_Wall, length) # Create matched precinct column
length_index_vec <- numeric(0)
for (i in 1:length(length_index)) {
vec <- numeric(length_index[i])
vec[1:length_index[i]] <- i
length_index_vec <- c(length_index_vec, vec)
}
Adjacent_Precinct_County_Wall <- Adjacent_Precinct_County_Wall %>% # Create inner ring match list
unlist() %>% cbind(length_index_vec) %>% # Create Counterpart matched precinct column
as.data.frame() %>%
janitor::clean_names() %>%
dplyr::rename(GEOID_B = x, GEOID_C = length_index_vec) %>%
dplyr::mutate(GEOID_B = State_Precinct_County$GEOID20[GEOID_B],
GEOID_C = State_Precinct_County$GEOID20[GEOID_C]) %>%
base::subset(GEOID_B %in% Precinct_Interior$GEOID) %>%
base::subset(!GEOID_C %in% Precinct_Interior$GEOID)
# Centroid initialization (for plots)
Precinct_Centroid_2nd <- rbind(st_transform(subset(State_Precinct_County,
GEOID20 %in% unique(Adjacent_Precinct_County_Wall$GEOID_C)), crs = CRS),
st_transform(subset(State_Precinct_County,
GEOID20 %in% unique(Adjacent_Precinct_County_Wall$GEOID_B)), crs = CRS)) %>%
dplyr::select(GEOID20, geometry) %>%
mutate(geometry = st_point_on_surface(geometry))
df <- Adjacent_Precinct_County_Wall %>%
left_join(dplyr::rename(Precinct_Centroid_2nd, GEOID_B = GEOID20), by = c("GEOID_B")) %>%
left_join(dplyr::rename(Precinct_Centroid_2nd, GEOID_C = GEOID20), by = c("GEOID_C"))
mach_lines_2nd <- st_sfc(mapply(function(a,b){st_cast(st_union(a,b),"LINESTRING")}, # Create lines for plots
df$geometry.x, df$geometry.y, SIMPLIFY=FALSE), crs = CRS)
plot_PA_Precinct_mach_lines <- ggplot() +
geom_sf(data = subset(State_Precinct_County, GEOID20 %in% unique(Adjacent_Precinct_County_Wall$GEOID_C)),
color = "black", fill = "dodgerblue4") +
geom_sf(data = Precinct_Exterior, color = "black", fill = "#d59d9e") +
geom_sf(data = Precinct_Interior, color = "black", fill = "dodgerblue2") +
geom_sf(data = subset(us_county, GEOID == County_GEOID), color = "red", fill = NA) +
geom_sf(data = mach_lines_2nd, color = "magenta3") +
geom_sf(data = Precinct_Centroid_2nd, color = "gray15") +
geom_sf(data = mach_lines, color = "deepskyblue1") +
geom_sf(data = Precinct_Centroid, color = "gray15") +
coord_sf()+
theme_void()+
scale_fill_viridis(discrete = TRUE)+
ggtitle("Allegheny County, Pennsylvania") +
labs(caption = "Figure iii") +
theme(legend.position = "none", plot.title = element_text(hjust = 0.5, size=35),
plot.caption = element_text(hjust = 0.5, size=20))
plot_PA_Precinct_mach_lines
# Adjacent_Precinct_County_Wall
mach_2nd <- Conglomerate_Absentee_data %>% # call inner ring Precincts
dplyr::select(c("GEOID20", Conglomerate_Absentee_variables, census_block_variables)) %>%
dplyr::right_join(dplyr::select(Adjacent_Precinct_County_Wall, GEOID_C), by = c("GEOID20" = "GEOID_C")) %>%
dplyr::select(!GEOID20)
mach_I_2 <- Conglomerate_Absentee_data %>% # call interior Precincts
dplyr::select(c("GEOID20", Conglomerate_Absentee_variables, census_block_variables)) %>%
dplyr::right_join(dplyr::select(Adjacent_Precinct_County_Wall, GEOID_B), by = c("GEOID20" = "GEOID_B")) %>%
dplyr::select(!GEOID20)
Precinct_match_data_2nd <- (mach_I_2 - mach_2nd) %>% na.omit # interior Precincts - inner ring Precincts
ggplot()+
geom_point(aes(x = Porp_Trump, y = Porp_Absentee), data = Precinct_match_data_2nd)+
geom_smooth(aes(x = Porp_Trump, y = Porp_Absentee), data = Precinct_match_data_2nd,
method = 'lm', formula = y ~ x)+
theme_light()+
ggtitle("Absentee % Vs Trump Vote; Allegheny & Surrounding Counties, Pennsylvania")+
labs(y = "% Total Votes Mailed In",
x = "% Votes for Trump Out of Total",
subtitle = "By Precinct, 2020 Presidential Election",
caption = quote(NULL))
ggplot() +
geom_sf(data = State_Precinct_County_GEO, color = "black", fill = "gray90") +
coord_sf()+
theme_void()+
scale_fill_viridis(discrete = TRUE)+
theme(legend.position = "none")
# Combine both rings of differences into one data frame
Precinct_match_data$ring <- "1st"
Precinct_match_data_2nd$ring <- "2nd"
Precinct_match_data_3rd <- rbind(Precinct_match_data, Precinct_match_data_2nd)
Precinct_match_data_3rd$ring <- factor(Precinct_match_data_3rd$ring,
levels = c("1st", "2nd"),
labels = c("Exterior", "Recessed"))
# Figure 3 plot
plot_PA_Abs_EDV_Diff <- ggplot(Precinct_match_data_3rd,
aes(y = Porp_Trump_Absentee, x = Porp_Trump_election_day, color = ring))+
geom_point()+
theme_light()+
ggtitle("Figure 3: Difference in Trump Absentee Vs In-Person Share; Allegheny Exterior & Recessed Paired Precincts")+
labs(y = "Difference in % of Mail-In Ballots for Trump",
x = "Difference in % of Election-Day Ballots for Trump",
subtitle = "Across Adjacent Precincts, 2020 Presidential Election",
caption = quote(NULL),
color = "Precinct Difference")+
scale_colour_manual(values=c("#c84c42", "#417ddd"))+
scale_y_continuous(labels = scales::percent)+
scale_x_continuous(labels = scales::percent)+
theme(legend.position='top')
plot_PA_Abs_EDV_Diff
save(Conglomerate_Absentee_Border, # Save model data
Precinct_match_data_3rd,
file = "PA/PA_model_data.Rdata")
save(plot_PA_Precinct_Border_example, # Save plots
plot_PA_Precinct_mach_lines,
plot_PA_Abs_EDV_UP,
plot_PA_Abs_EDV_Diff,
file = "PA/PA_plots.Rdata")
library(tidyverse)
library(dplyr)
load("PA/PA_model_data.Rdata")
# Unpaired models
lm_PA_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + County_lm, # Reduce model
data = Conglomerate_Absentee_Border)
lm_PA <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + County_lm + Minority + Age + income + Internet + vehicle + School, # Full model
data = Conglomerate_Absentee_Border)
lm_PA %>% summary
lmtest::coeftest(lm_PA, vcov = sandwich::vcovHC(lm_PA, "HC3"))
lm_PA %>% plot(1, main = "Full")
lm_PA_m %>% plot(1)
lm_PA %>% plot(2, main = "Full")
lm_PA_m %>% plot(2)
(PA_anova <- anova(lm_PA_m, lm_PA, test = "F")) # F test
Precinct_match_data_3rd <- Precinct_match_data_3rd %>% # Put factor variable in correct order
dplyr::mutate(ring = factor(ring, levels = c("Recessed", "Exterior")))
lm_PA_D_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + ring, data = Precinct_match_data_3rd) # Reduce model
lm_PA_D <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + ring + Minority + Age + income + Internet + vehicle + School, # Full model
data = Precinct_match_data_3rd)
lm_PA_D %>% summary
lm_PA_D %>% plot(1, main = "Full")
lm_PA_D_m %>% plot(1)
lm_PA_D %>% plot(2, main = "Full")
lm_PA_D_m %>% plot(2)
lmtest::coeftest(lm_PA_D_m, vcov = sandwich::vcovHC(lm_PA_D_m, "HC3"))
(PA_anova_D <- anova(lm_PA_D_m, lm_PA_D, test = "F")) # F test
# Test that negative of difference calculation does not affect conclusions
# Precinct_match_data_3rd_neg1 <- Precinct_match_data_3rd %>%
#   dplyr::mutate(Porp_Trump_Absentee = Porp_Trump_Absentee * (-1),
#                 Porp_Trump_election_day = Porp_Trump_election_day * (-1),
#                 Minority = Minority * (-1),
#                 Age = Age * (-1),
#                 income = income * (-1),
#                 Internet = Internet * (-1),
#                 vehicle = vehicle * (-1))
# lm_PA_D_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day * ring + Minority + Age + income + Internet + vehicle, data = Precinct_match_data_3rd_neg1)
# lm_PA_D_m %>% summary
# lm_PA_D_m %>% plot
save(lm_PA,
lm_PA_D,
PA_anova,
PA_anova_D,
file = "PA/PA_Models.Rdata")
# Unpaired models
lm_PA_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + County_lm, # Reduce model
data = Conglomerate_Absentee_Border)
lm_PA <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + County_lm + Minority + Age + income + Internet + vehicle + School, # Full model
data = Conglomerate_Absentee_Border)
lm_PA %>% summary
# lmtest::coeftest(lm_PA, vcov = sandwich::vcovHC(lm_PA, "HC3"))
lm_PA %>% plot(1, main = "Full")
lm_PA_m %>% plot(1)
lm_PA %>% plot(2, main = "Full")
lm_PA_m %>% plot(2)
(PA_anova <- anova(lm_PA_m, lm_PA, test = "F")) # F test
Precinct_match_data_3rd <- Precinct_match_data_3rd %>% # Put factor variable in correct order
dplyr::mutate(ring = factor(ring, levels = c("Recessed", "Exterior")))
lm_PA_D_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + ring, data = Precinct_match_data_3rd) # Reduce model
lm_PA_D <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + ring + Minority + Age + income + Internet + vehicle + School, # Full model
data = Precinct_match_data_3rd)
lm_PA_D %>% summary
lm_PA_D %>% plot(1, main = "Full")
lm_PA_D_m %>% plot(1)
lm_PA_D %>% plot(2, main = "Full")
lm_PA_D_m %>% plot(2)
# lmtest::coeftest(lm_PA_D_m, vcov = sandwich::vcovHC(lm_PA_D_m, "HC3"))
(PA_anova_D <- anova(lm_PA_D_m, lm_PA_D, test = "F")) # F test
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
knitr::opts_chunk$set(warning = FALSE)
# library(knitr)
# hook_plot = knit_hooks$get('plot')
# knit_hooks$set(plot = function(x, options) paste('\n', hook_plot(x, options), sep = ''))
t1 <- stargazer(lm_PA,
header = FALSE, model.numbers = FALSE,
# order = c(1,2,7,3,4,5,6,8),
dep.var.labels = "Trump Absentee Vote Share",
covariate.labels = c("Trump Election-Day\\\\ Vote Share",
"Exterior Precinct",
"Minority",
"Age",
"Income",
"Internet",
"Vehicle",
"School",
"Intercept"),
# omit.stat = c("f", "rsq", "ser"),
# font.size = "scriptsize",
type = 'latex', float = FALSE)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
knitr::opts_chunk$set(warning = FALSE)
# library(knitr)
# hook_plot = knit_hooks$get('plot')
# knit_hooks$set(plot = function(x, options) paste('\n', hook_plot(x, options), sep = ''))
# Required packages
library(tidyverse)
library(sf)
library(dplyr)
library(rgeos)
library(rgdal)
library(gridExtra)
library(viridis)
library(pdftools)
library(readxl)
library(janitor)
library(stringr)
library(tidycensus)
tidycensus::census_api_key("5f98a6c74bd7ae588481b45d22d48b487611ab89")
library(stargazer)
load("PA/PA_plots.Rdata")
load("GA/GA_plots.Rdata")
load("PA/PA_Models.Rdata")
load("GA/GA_Models.Rdata")
gridExtra::grid.arrange(plot_PA_Precinct_Border_example, plot_GA_Precinct_Border_example, ncol = 2)
plot_PA_Abs_EDV_UP
stargazer(lm_PA,
header = FALSE, model.numbers = FALSE,
# order = c(1,2,7,3,4,5,6,8),
dep.var.labels = "Trump Absentee Vote Share",
covariate.labels = c("Trump Election-Day\\\\ Vote Share",
"Exterior Precinct",
"Minority",
"Age",
"Income",
"Internet",
"Vehicle",
"School",
"Intercept"),
# omit.stat = c("f", "rsq", "ser"),
# font.size = "scriptsize",
type = 'latex', float = FALSE)
t1 <- stargazer(lm_PA,
header = FALSE, model.numbers = FALSE,
# order = c(1,2,7,3,4,5,6,8),
dep.var.labels = "Trump Absentee Vote Share",
covariate.labels = c("Trump Election-Day\\\\ Vote Share",
"Exterior Precinct",
"Minority",
"Age",
"Income",
"Internet",
"Vehicle",
"School",
"Intercept"),
# omit.stat = c("f", "rsq", "ser"),
# font.size = "scriptsize",
type = 'latex', float = FALSE)
t2 <- stargazer(lm_GA,
header = FALSE, model.numbers = FALSE,
# order = c(1,2,7,3,4,5,6,8),
dep.var.labels = "Trump Absentee Vote Share",
covariate.labels = c("Trump Election-Day\\\\ Vote Share",
"Democrat\\\\ Exterior Precinct",
"Republican\\\\ Exterior Precinct",
"Minority",
"Age",
"Income",
"Internet",
"Vehicle",
"School",
"Intercept"),
# omit.stat = c("f", "rsq", "ser"),
# font.size = "scriptsize",
type = 'latex', float = FALSE)
knitr::kable(list(t1, t2))
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
knitr::opts_chunk$set(warning = FALSE)
# library(knitr)
# hook_plot = knit_hooks$get('plot')
# knit_hooks$set(plot = function(x, options) paste('\n', hook_plot(x, options), sep = ''))
# Required packages
library(tidyverse)
library(sf)
library(dplyr)
library(rgeos)
library(rgdal)
library(gridExtra)
library(viridis)
library(pdftools)
library(readxl)
library(janitor)
library(stringr)
library(tidycensus)
tidycensus::census_api_key("5f98a6c74bd7ae588481b45d22d48b487611ab89")
library(stargazer)
load("PA/PA_plots.Rdata")
load("GA/GA_plots.Rdata")
load("PA/PA_Models.Rdata")
load("GA/GA_Models.Rdata")
gridExtra::grid.arrange(plot_PA_Precinct_Border_example, plot_GA_Precinct_Border_example, ncol = 2)
plot_PA_Abs_EDV_UP
plot_GA_Abs_EDV_UP
library(tidyverse)
library(dplyr)
load("GA/GA_model_data.Rdata")
# Unpaired models
lm_GA_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + county_party, # Reduce model
data = Conglomerate_Absentee_Border)
lm_GA <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + county_party + Minority + Age + income + Internet + vehicle + School, # Full model
data = Conglomerate_Absentee_Border)
lm_GA %>% summary
# lmtest::coeftest(lm_GA, vcov = sandwich::vcovHC(lm_GA, "HC3"))
(lm_GA_ris <- lm_GA %>% plot(1))
lm_GA_m %>% plot(1)
(lm_GA_nor <- lm_GA %>% plot(2))
lm_GA_m %>% plot(2)
(GA_anova <- anova(lm_GA_m, lm_GA, test = "F")) # F test
# Precinct matching models
lm_GA_D_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + ring, data = Precinct_match_data_3rd) # Reduce model
lm_GA_D <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + ring + Minority + Age + income + Internet + vehicle + School, # Full model
data = Precinct_match_data_3rd)
lm_GA_D %>% summary
# lmtest::coeftest(lm_GA_D, vcov = sandwich::vcovHC(lm_GA_D, "HC3"))
(lm_GA_D_ris <- lm_GA_D %>% plot(1))
lm_GA_D_m %>% plot(1)
(lm_GA_D_nor <- lm_GA_D %>% plot(2))
lm_GA_D_m %>% plot(2)
(GA_anova_D <- anova(lm_GA_D_m, lm_GA_D, test = "F")) # F test
# Test that negative of difference calculation does not affect conclusions
# Precinct_match_data_3rd_neg1 <- Precinct_match_data_3rd %>%
#   dplyr::mutate(Porp_Trump_Absentee = Porp_Trump_Absentee * (-1),
#                 Porp_Trump_election_day = Porp_Trump_election_day * (-1),
#                 Minority = Minority * (-1),
#                 Age = Age * (-1),
#                 income = income * (-1),
#                 Internet = Internet * (-1),
#                 vehicle = vehicle * (-1))
# lm_GA_D <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day * ring + Minority + Age + income + Internet + vehicle, data = Precinct_match_data_3rd_neg1)
# lm_GA_D %>% summary
# lm_GA_D %>% plot
save(lm_GA,
lm_GA_D,
GA_anova,
GA_anova_D,
lm_GA_ris, lm_GA_nor,
lm_GA_D_ris, lm_GA_D_nor,
file = "GA/GA_Models.Rdata")
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
knitr::opts_chunk$set(warning = FALSE)
lm_GA_ris
(lm_GA_ris <- lm_GA %>% plot(1))
lm_GA %>% plot(1)
lm_GA_ris <- lm_GA %>% plot(1)
lm_GA_ris <- lm_GA %>% plot(1)
lm_GA_ris <- lm_GA %>% plot
lm_GA %>% plot(1)
par(mfrow = c(2,1))
lm_GA %>% plot(1)
lm_GA %>% plot(2)
library(tidyverse)
library(dplyr)
load("PA/PA_model_data.Rdata")
# Unpaired models
lm_PA_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + County_lm, # Reduce model
data = Conglomerate_Absentee_Border)
lm_PA <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + County_lm + Minority + Age + income + Internet + vehicle + School, # Full model
data = Conglomerate_Absentee_Border)
lm_PA %>% summary
# lmtest::coeftest(lm_PA, vcov = sandwich::vcovHC(lm_PA, "HC3"))
lm_PA %>% plot(1, main = "Full")
lm_PA_m %>% plot(1)
lm_PA %>% plot(2, main = "Full")
lm_PA_m %>% plot(2)
(PA_anova <- anova(lm_PA_m, lm_PA, test = "F")) # F test
Precinct_match_data_3rd <- Precinct_match_data_3rd %>% # Put factor variable in correct order
dplyr::mutate(ring = factor(ring, levels = c("Recessed", "Exterior")))
lm_PA_D_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + ring, data = Precinct_match_data_3rd) # Reduce model
lm_PA_D <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + ring + Minority + Age + income + Internet + vehicle + School, # Full model
data = Precinct_match_data_3rd)
lm_PA_D %>% summary
lm_PA_D %>% plot(1, main = "Full")
lm_PA_D_m %>% plot(1)
lm_PA_D %>% plot(2, main = "Full")
lm_PA_D_m %>% plot(2)
# lmtest::coeftest(lm_PA_D_m, vcov = sandwich::vcovHC(lm_PA_D_m, "HC3"))
(PA_anova_D <- anova(lm_PA_D_m, lm_PA_D, test = "F")) # F test
# Test that negative of difference calculation does not affect conclusions
# Precinct_match_data_3rd_neg1 <- Precinct_match_data_3rd %>%
#   dplyr::mutate(Porp_Trump_Absentee = Porp_Trump_Absentee * (-1),
#                 Porp_Trump_election_day = Porp_Trump_election_day * (-1),
#                 Minority = Minority * (-1),
#                 Age = Age * (-1),
#                 income = income * (-1),
#                 Internet = Internet * (-1),
#                 vehicle = vehicle * (-1))
# lm_PA_D_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day * ring + Minority + Age + income + Internet + vehicle, data = Precinct_match_data_3rd_neg1)
# lm_PA_D_m %>% summary
# lm_PA_D_m %>% plot
PA_anova$Df
PA_anova
PA_anova$Res.Df
PA_anova$F
PA_anova$F
PA_anova$`Pr(>F)`
PA_anova
PA_anova$F
PA_anova$Res.Df
PA_anova$Df
PA_anova$`Pr(>F)`
PA_anova
PA_anova$F[2]
PA_anova$Res.Df[2]
PA_anova$Df[2]
PA_anova$`Pr(>F)`[2]
PA_anova$`Pr(>F)`[2]
PA_anova
(PA_anova <- anova(lm_PA_m, lm_PA, test = "F")) # F test
(PA_anova <- anova(lm_PA_m, lm_PA, test = "F")) # F test
PA_anova$Df[2]
PA_anova$Res.Df[2]
PA_anova$F[2]
PA_anova$`Pr(>F)`[2]
(PA_anova <- anova(lm_PA_m, lm_PA, test = "F")) # F test
PA_anova$Df[2]
PA_anova$Res.Df[2]
round(PA_anova$F[2],2)
round(PA_anova$`Pr(>F)`[2],2)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(include = FALSE)
knitr::opts_chunk$set(warning = FALSE)
PA_anova_DF <- PA_anova$Df[2]
PA_anova_Res.Df <- PA_anova$Res.Df[2]
PA_anova_F <- round(PA_anova$F[2],2)
PA_anova_P <- round(PA_anova$`Pr(>F)`[2],2)
library(tidyverse)
library(dplyr)
load("GA/GA_model_data.Rdata")
# Unpaired models
lm_GA_m <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + county_party, # Reduce model
data = Conglomerate_Absentee_Border)
lm_GA <- lm(Porp_Trump_Absentee ~ Porp_Trump_election_day + county_party + Minority + Age + income + Internet + vehicle + School, # Full model
data = Conglomerate_Absentee_Border)
lm_GA %>% summary
# lmtest::coeftest(lm_GA, vcov = sandwich::vcovHC(lm_GA, "HC3"))
lm_GA %>% plot(1, main = "Full")
lm_GA_m %>% plot(1)
lm_GA %>% plot(2, main = "Full")
lm_GA_m %>% plot(2)
(GA_anova <- anova(lm_GA_m, lm_GA, test = "F")) # F test
GA_anova$`Pr(>F)`[2]
