"0","# Precinct centroids and cross County matching lines creation"
"0",""
"0","Precinct_Centroid <- rbind(st_transform(Precinct_Exterior, crs = CRS), st_transform(Precinct_Interior, crs = CRS)) %>% "
"0","  dplyr::select(GEOID, geometry) %>%"
"0","  mutate(geometry = st_point_on_surface(geometry)) # Convert border precinct shapes into centroids"
"0",""
"0","length_index <- sapply(Adjacent_List_Border, length) # Convert index of list into column for data frame"
"0","length_index_vec <- numeric(0)"
"0","for (i in 1:length(length_index)) {"
"0","  vec <- numeric(length_index[i])"
"0","  vec[1:length_index[i]] <- i"
"0","  length_index_vec <- c(length_index_vec, vec)"
"0","}"
"0",""
"0","df <- Adjacent_List_Border %>% # Create adjacency data frame for recessed"
"0","  unlist() %>% cbind(length_index_vec) %>% # Fully convert adjacency list into two columns"
"0","  as.data.frame() %>% "
"0","  janitor::clean_names() %>% "
"0","  dplyr::rename(GEOID_A = x, GEOID_B = length_index_vec) %>% "
"0","  dplyr::mutate(COUNTY_A = Precinct_Border_Spatial$COUNTYFP[GEOID_A],"
"0","                COUNTY_B = Precinct_Border_Spatial$COUNTYFP[GEOID_B],"
"0","                GEOID_A = Precinct_Border_Spatial$GEOID[GEOID_A], "
"0","                GEOID_B = Precinct_Border_Spatial$GEOID[GEOID_B]) %>% # Replace row IDs with precinct GEOIDs"
"0","  base::subset(COUNTY_A != COUNTY_B) %>% "
"0","  base::subset(COUNTY_A == county_code | COUNTY_B == county_code) %>% "
"0","  left_join(dplyr::rename(Precinct_Centroid, GEOID_A = GEOID), by = c(""GEOID_A"")) %>% "
"0","  left_join(dplyr::rename(Precinct_Centroid, GEOID_B = GEOID), by = c(""GEOID_B""))"
"0",""
"0","mach_lines <- st_sfc(mapply(function(a,b){st_cast(st_union(a,b),""LINESTRING"")}, "
"0","                                df$geometry.x, df$geometry.y, SIMPLIFY=FALSE), crs = CRS) # Create lines between precinct pairs"
"0",""
"0","plot_GA_Precinct_mach_lines <- ggplot() +"
"0","  geom_sf(data = Precinct_Exterior, color = ""black"", fill = ""gray90"") +"
"0","  geom_sf(data = Precinct_Interior, color = ""black"", fill = ""gray80"") +"
"0","  geom_sf(data = subset(us_county, GEOID == County_GEOID), color = ""red"", fill = NA) +"
"0","  geom_sf(data = mach_lines, color = ""blue"", fill = ""gray90"") +"
"0","  geom_sf(data = Precinct_Centroid, color = ""black"", fill = ""gray90"") +"
"0","  coord_sf()+"
"0","  theme_void()+"
"0","  scale_fill_viridis(discrete = TRUE)+"
"0","  ggtitle(""Fulton"")+"
"0","  theme(legend.position = ""none"")"
