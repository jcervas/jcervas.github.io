"0","State_Precinct_County_Spatial <- State_Precinct_County %>% "
"0","  sf::as_Spatial()"
"0",""
"0","Adjacent_Precinct_County <- spdep::poly2nb(sp::as.SpatialPolygons.PolygonsList(State_Precinct_County_Spatial@polygons), "
"0","                                         snap = poly2nb_snap)"
"0",""
"0","# precinct matching pairs"
"0","length_index <- sapply(Adjacent_Precinct_County, length)"
"0",""
"0","length_index_vec <- numeric(0)"
"0",""
"0","for (i in 1:length(length_index)) {"
"0","  vec <- numeric(length_index[i])"
"0","  vec[1:length_index[i]] <- i"
"0","  length_index_vec <- c(length_index_vec, vec)"
"0","}"
"0",""
"0","Adjacent_Precinct_County <- Adjacent_Precinct_County %>% "
"0","  unlist() %>% "
"0","  cbind(length_index_vec) %>% "
"0","  as.data.frame() %>% "
"0","  janitor::clean_names() %>% "
"0","  dplyr::rename(GEOID_B = x, GEOID_C = length_index_vec) %>%"
"0","  dplyr::mutate(GEOID_B = State_Precinct_County$GEOID20[GEOID_B],"
"0","                GEOID_C = State_Precinct_County$GEOID20[GEOID_C]) %>% "
"0","  base::subset(GEOID_B %in% Precinct_Interior$GEOID) %>% "
"0","  base::subset(!GEOID_C %in% Precinct_Interior$GEOID)"
"0",""
"0","# Centroid initialization"
"0","Precinct_Centroid_2nd <- rbind(st_transform(subset(State_Precinct_County, "
"0","                                                   GEOID20 %in% unique(Adjacent_Precinct_County$GEOID_C)), crs = CRS), "
"0","                           st_transform(subset(State_Precinct_County, "
"0","                                               GEOID20 %in% unique(Adjacent_Precinct_County$GEOID_B)), crs = CRS)) %>% "
"0","  dplyr::select(GEOID20, geometry) %>%"
"0","  mutate(geometry = st_point_on_surface(geometry))"
"0",""
"0","df <- Adjacent_Precinct_County %>% "
"0","  left_join(dplyr::rename(Precinct_Centroid_2nd, GEOID_B = GEOID20), by = c(""GEOID_B"")) %>% "
"0","  left_join(dplyr::rename(Precinct_Centroid_2nd, GEOID_C = GEOID20), by = c(""GEOID_C""))"
"0",""
"0","mach_lines_2nd <- st_sfc(mapply(function(a,b){st_cast(st_union(a,b),""LINESTRING"")}, "
"0","                                df$geometry.x, df$geometry.y, SIMPLIFY=FALSE), crs = CRS)"
"0",""
"0","# match map"
"0","Fulton_Republican_County_conversion_table <- us_county_state %>% "
"0","  sf::st_drop_geometry() %>% "
"0","  base::subset(toupper(NAME) %in% c(""CARROLL"", ""CHEROKEE"", ""COWETA"", ""FORSYTH"", ""FAYETTE""))"
"0",""
"0","Precinct_Exterior$geometry_color <- with(Precinct_Exterior, "
"0","                                ifelse(Precinct_Exterior$COUNTYFP %in% Fulton_Republican_County_conversion_table$COUNTYFP,"
"0","                                            ""Democrat"", ""Republican""))"
"0",""
"0","Precinct_Interior$geometry_color <- ""Fulton"""
"0",""
"0","Precinct_Recessed <- subset(State_Precinct_County, GEOID20 %in% unique(Adjacent_Precinct_County$GEOID_C))"
"0","Precinct_Recessed$geometry_color <- ""Recessed"""
"0",""
"0",""
"0","Precinct_All_match <- base::rbind(st_transform(dplyr::select(Precinct_Exterior, c(""geometry_color"", ""geometry"")), crs = CRS),"
"0","                                  st_transform(dplyr::select(Precinct_Interior, c(""geometry_color"", ""geometry"")), crs = CRS),"
"0","                                  st_transform(dplyr::select(Precinct_Recessed, c(""geometry_color"", ""geometry"")), crs = CRS))"
"0",""
"0","# Adjacent_Precinct_County"
"0",""
"0","mach_2nd <- Conglomerate_Absentee_data %>% "
"0","  dplyr::mutate(GEOID20 = as.numeric(GEOID20)) %>% "
"0","  dplyr::select(c(""GEOID20"", Conglomerate_Absentee_variables, census_block_variables)) %>% "
"0","  dplyr::right_join(dplyr::select(Adjacent_Precinct_County, GEOID_C), by = c(""GEOID20"" = ""GEOID_C"")) %>% "
"0","  dplyr::select(!GEOID20)"
"0",""
"0","mach_I_2 <- Conglomerate_Absentee_data %>% "
"0","  dplyr::mutate(GEOID20 = as.numeric(GEOID20)) %>% "
"0","  dplyr::select(c(""GEOID20"", Conglomerate_Absentee_variables, census_block_variables)) %>% "
"0","  dplyr::right_join(dplyr::select(Adjacent_Precinct_County, GEOID_B), by = c(""GEOID20"" = ""GEOID_B"")) %>% "
"0","  dplyr::select(!GEOID20)"
"0",""
"0","Precinct_match_data_2nd <- (mach_I_2 - mach_2nd) %>% na.omit"
"0",""
"0","ggplot() +"
"0","  geom_sf(data = State_Precinct_County_GEO, color = ""black"", fill = ""gray90"") +"
"0","  coord_sf()+"
"0","  theme_void()+"
"0","  scale_fill_viridis(discrete = TRUE)+"
"0","  theme(legend.position = ""none"")"
